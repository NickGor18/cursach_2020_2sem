\usepackage[cp1251]{inputenc}
\chapter{Численные эксперименты}
\paragraph{Применение метода MPC к решению задачи об экономическом росте}
\hfill\break
Рассмотрим задачу (2.14).
\begin{center}
$ \dot{x}(t) = u(t) f(x(t))-\mu x(t),u (t)\in U_\varepsilon = [0 ,1-\varepsilon], $\\
$ x(0) = x_0, x \ge 0$\\
$ J(x,u) = \int_{0}^{\infty}
e^{-\rho t}[\ln(1-u(t))+\ln f(x(t))]dt \rightarrow \max.$
\end{center}
Цель данной главы - применить методы решения ЗОУ(в т.ч. методы MPC) для решения данной задачи.
Для решения задачи воспользуемся алгоритмом, который был указан в пунтке 1.3. Рассматривать будем прогнозирующую задачу Лагранжа(п. 1.2), т.е.
\begin{center}
	$ J(x,u) = \int_{0}^{z} e^{-\rho t}[\ln(1-u(t))+\ln f(x(t))]dt $
\end{center}
Решение задачи будем искать численно в классе кусочно-постоянных функций, то есть
\begin{center}
	$ u(t) = u_i, t \in [ih, (i+1)h], i = 0,...,T-1 $
\end{center}
где $ h = z/T $ - период дискретизации, $ T \in \mathbb{N}$. $ T $ - дискретный горизонт планирования.\\
Фазовая же переменная $ x $ и уравнение для её рассчета изменятся следующим образом:
\begin{center}
	$ \dot{x}_{i+1} = u_i f(x_i)-\mu x_i$
\end{center}

\hspace*{1cm} В таком случае интегральное слагаемое нашей задачи имеет следующий вид:
\begin{center}
	\begin{doublespace}
		$ J(x,u) = \sum_{i=0}^{T-1}\int_{ih}^{(i+1)h} e^{-\rho t}[\ln(1-u_i)+\ln f(x_i)]dt =$ \\  $ \sum_{i=0}^{T-1}\dfrac{[\ln(1-u_i)+\ln f(x_i)]}{\rho} \left(e^{-\rho(i+1)h} -  e^{-\rho ih}\right)$
	\end{doublespace}
\end{center}

В итоге мы получаем следующую дискретизированую задачу:
\begin{center}
	\begin{doublespace}
	$ \dot{x}_{i+1} = u_i f(x_i)-\mu x_i, u_i\in U_\varepsilon = [0 ,1-\varepsilon], x(0) = x_0, x_i \ge 0$\\
	$ J(x,u) = \sum_{i=0}^{T-1}\dfrac{[\ln(1-u_i)+\ln f(x_i)]}{\rho} \left(e^{-\rho(i+1)h} -  e^{-\rho ih}\right)$
	\end{doublespace}
\end{center}
Таким образом, задача оптимального управления в классе дискретных управляющих воздействий свелась к задаче нелинейного прогаммирования. Для ее численного решения существует ряд реализованных программно процедур, в частности, в рамках курсовой работы будет использвоаться стандартная процедура fminsearch пакета Matlab.\\
В качестве производственной функции мы рассматриваем:
 \begin{center}
 	$ f(x) = x^\alpha $
 \end{center}
В задаче будем использовать следующие параметры: $ T = 10, \alpha = 0.3, \mu = 0.03, \rho = 0.05, \varepsilon = 0.01 $.\\
\hspace*{1cm} Решая для устойчивого состояния получим
\begin{center}
	$ x^* = 6.675, u^* =  0.627$
\end{center}
\paragraph{Листинг программы}
\begin{verbatim}
	[k, c] = mpcsolve(iterationsnum, horizon,...
	@(t,k,c)applycontrol(t0,k0,c),...
	@(t,k,c)stagecost(t0,k0,c), ...
	k0, t0, dt, c0);
	%@(t,k,c) nlconstraint(t,dt,k,c,deq));
	function x = applycontrol(t0,k0,c)
	[~, x] = ode45(@(c,x)deq(c,k0),[t0, t0+1], k0);
	x = x(end);
	end
	function [x, u] = mpcsolve(iterationsnum, horizon,... 
	applycontrol, stagecost,...
	x0, t0, dt,u0)
	t = t0;
	x = zeros(horizon + 1,iterationsnum);
	x(1,1) = x0; 
	u = zeros(horizon,iterationsnum);
	r=u;
	for i = 1:iterationsnum 
	a = x(1,i);
	u(:, i) = fminsearch(@(u)costfun(applycontrol,...
	stagecost,a,t,dt,u),u0);
	for j = 1:horizon
	x(j+1,i) = applycontrol(t + j*dt,x(j,i),u(j,i));
	end
	x(1,i+1) = x(2,i); 
	t = t + dt;
	end
	%x = sum(sum(x))/(iterationsnum*(horizon+1));
	end
	function [cost] = costfun(applycontrol,...
	stagecost, x0,t0,dt,u) 
	cost = 0; 
	x = x0; 
	t = t0; 
	
	cost = cost + stagecost(t, x, u); 
	x = applycontrol(t,x,u); 
	t = t + dt;
	
	end
	
	function [r] = stagecost(t, k, c)
	rho = 0.05;
	alpha = 0.3;
	l = (log(1 - c) + log(k^alpha))/rho;
	r = l*(exp(-rho * (t+1))-exp(-rho * t));
	end
	function [v] = deq(c,k)
	mu = 0.03;
	alpha = 0.3;
	v = c*k^alpha - mu*k;
	end
\end{verbatim}